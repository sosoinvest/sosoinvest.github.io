---
layout: single
title:  "[투자전략-15] 변동성 정의에 따른 돌파전략 성과"
description: 변동성 돌파전략에서 변동성 정의에 따른 성과 비교
categories: 투자
tag: [주식, 퀀트]
toc: true
author_profile: false
header:
 teaser: /images/2025-02-02-vol-definition/total_figure_K03.webp
 og_image: /images/2025-02-02-vol-definition/total_figure_K03.webp
# sidebar:
#     nav: "docs"
# search: true
---
# Systrader 79
[systrader79는 블로그](https://stock79.tistory.com/entry/%EC%8B%9C%EA%B0%80-%EA%B8%B0%EC%A4%80-%EC%BA%94%EB%93%A4-%EC%A7%80%ED%91%9C%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%B3%80%EB%8F%99%EC%84%B1-%EB%8F%8C%ED%8C%8C-%EC%A0%84%EB%9E%B5-131)에서 다양한 퀀트 전략들을 공개하고 있는데, 참고할만한 유익한 내용이 많다. 변동성 돌파 전략은 그의 블로그에서 자주 다루는 주요 전략 중 하나이다.

systrader79의 블로그에서 변동성 정의에 대한 흥미로운 글을 발견해서 백테스트로 재현해봤다. 자세한 내용은 위의 링크를 참조 바란다.

일반적으로 변동성 돌파전략은 전일 고가와 저가의 폭(고가-저가)으로 변동성을 계량한다. 이러한 정의는 전일 주가가 상승했는지 또는 하락했는지에 관계없이 단순히 정의한 것이다. systrader79는 그의 글에서 전일 고가와 저가의 폭(시가-저가) 보다 전일 시가와 저가의 폭이 더 유리하다고 언급했다. 그 이유로는 전일 양봉으로 마감한 경우 더 민감하게 반응하고, 음봉으로 마감한 경우는 저 둔감하게 반응하기 때문으로 설명했다.

반대로 시가대비 고가의 폭(고가-시가)를 기준으로 변동성을 계량할 경우, 상승할 떄 더 느리게 반응하고 하락에는 더 민감하게 반응하게 된다. 결과적으로 더 불리한 경우에 전략이 작동하게 된다.

그의 블로그에는 백테스트 결과도 나와있는데, 정말로 시가대비 저가로 변동성을 정의한 경우가 훨씬 성과가 좋았다. 그러나 아쉽지만 어떤 종목을 대상으로 백테스트 했는지는 언급되어 있지않았다.

# 백테스트 조건
여기서는 코스닥 150 지수에 대해 이러한 변동폭의 정의에 따른 성과를 비교했다. 총 네가지 변동폭을 비교했다.
 
1. 전일 고가 - 전일 저가
2. 전일 시가 - 전일 저가
3. 전일 고가 - 전일 시가
4. True range =max(전일 고가 - 전일 저가, abs(전일 고가-전전일 종가), abs(전일 저가-전전일종가)) 

- 백테스트 대상: [KODEX 코스닥150](https://finance.naver.com/item/main.naver?code=229200)

- 백테스트 기간: 2015.10.01 ~ 2025.01.24

- 세금: 0%
: *국장 ETF이기 때문에 거래세와 양도세가 없다.

- 거래 수수료: 0.0036%
: *한국투자증권 계좌의 국내주식 거래 수수료를 적용했다.

## 계산 조건
**변동성 돌파전략**의 매매조건은 아래와 같다.

<div class="notice--primary">
<ul>
    <li style="font-size: 1.25em;">전일 주가 데이터를 이용하여 변동폭을 구한다. 여기서 변동폭은 위의 네가지 경우를 고려하였다. </li>
    <li style="font-size: 1.25em;">시가+K*변동폭으로 타겟 매수가를 정하고, 오늘 장중 가격이 이 가격을 초과하면 매수한다.</li>
    <li style="font-size: 1.25em;">익일 시가에 모두 매도한다.</li>
</ul>
</div>

변동성 돌파전략의 자세한 것은 다음 글들을 참고하기 바란다.

- [래리 윌리엄스의 변동성 돌파전략 (파이썬 코드 있음)](/투자/volatility-break-out-strategy/)
- [절대로 지지않는 롱 전략](/투자/never-losing-long-strategy)
- [곱버스를 우상향시키는 방법](/투자/upward-sloping-inverse-double)
- [변동성 돌파전략 포지션 청산방법의 효과](/투자/vol-brk-out-close-method)

# 백테스트 결과
이전의 글에서는 K=0.5 보다 K=0.3이 평균적으로 더 우수한 수익률을 보여줬으므로, 여기서는 K=0.3과 K=0.5를 모두 고려하여 백테스트하였다. 

아래의 표는 네가지 변동폭에 따른 변동성 돌파전략을 백테스트한 모든 경우의 결과이다. 
- High-to-low: 전일 고가 - 전일 저가
- Open-to-low: 전일 시가 - 전일 저가
- High-to-open: 전일 고가 - 전일 시가
- TR: True range

Buy and hold의 결과는 최종 수익률 21.32%, MDD -57.22%, 샤프지수 -0.19이다.

*표 1: 변동폭 정의에 따른 변동성 돌파전략 백테스트 결과*

| K | 변동폭 | 최종 수익률 | MDD | CAGR |매매일수 |승률 |평균 수익률 |평균 손실율 |RR비율 |샤프지수 |
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|0.3|High-to-low|438.11%|-25.64%|17.09%|1330|56.09%|1.04%|-0.41%|2.54|0.98|
||Open-to-low|317.08%|-40.7%|12.05%|1742|53.79%|1.11%|-0.69%|1.61|0.57|
||High-to-open|244.11%|-47.54%|9.17%|1756|54.21%|1.12%|-0.74%|1.51|0.41|
||TR|348.83%|-26.58%|14.94%|1269|55.87%|1.03%|-0.38%|2.71|0.88|
|0.5|High-to-low|369.41%|-16.68%|16.88%|912|56.91%|0.97%|-0.2%|4.85|1.28|
||Open-to-low|359.69%|-31.52%|14.4%|1500|54.33%|1.07%|-0.51%|2.1|0.76|
||High-to-open|275.05%|-34.76%|11.41%|1547|54.36%|1.1%|-0.57%|1.93|0.57|
||TR|361.32%|-15.84%|16.93%|818|57.58%|0.96%|-0.17%|5.65|1.37|

백테스트 결과에서는 systrader의 글에서 보았던 시가-저가로 변동폭을 정의하였을 때 개선된 성과가 보이지 않았다. 오히려 기존의 전일 고가- 전일 저가의 경우가 CAGR도 높고 MDD가 낮았다. 

systrader와 같은 데이터로 테스트 한 것이 아니기 때문에 맞다 틀리다 평가할 수는 없다. 이 결과는 최근 10년간 코스닥 150 지수에 대해서는 기존의 변동폭 정의가 더 잘 작동함을 보여준다.

## 백테스트 수익 곡선 
아래의 수익곡선에서도 기존 변동폭의 정의가 더 잘 작동함을 눈으로 확인할 수 있다. 

<p align="center">   
    <img src="/images/2025-02-02-vol-definition//total_figure_K03.webp" alt="K=0.3 경우의 백테스트 결과">
    <br>
   <span style="font-style: italic; color: #FFFFFF;">Fig. 1 백테스트 결과 K = 0.3</span>
</p>

<p align="center">   
    <img src="/images/2025-02-02-vol-definition//total_figure_K05.webp" alt="K=0.5 경우의 백테스트 결과">
    <br>
   <span style="font-style: italic; color: #FFFFFF;">Fig. 2 백테스트 결과 K = 0.5</span>
</p>
