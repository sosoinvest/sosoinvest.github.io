---
layout: single
title:  "[투자전략] 변동성 돌파전략: 모멘텀과 변동폭의 영향 (4)"
description: 래리 윌리엄스(Larry Williams)의 변동성 돌파전략에서 모멘텀과 변동폭이 수익률에 미치는 영향을 분석할 글
categories: 투자
tag: [주식,퀀트,백테스트,파이썬]
toc: true
author_profile: false
header:
 teaser: /images/2024-10-19-volatility-break-out-strategy-extend/price_width_vs_return.webp
 og_image: /images/2024-10-19-volatility-break-out-strategy-extend/price_width_vs_return.webp

# sidebar:
#     nav: "docs"
# search: true
---
지난 글에서 확인했듯이, 래리 윌리엄스의 변동성 돌파전략은 코스닥 150 레버리지 대상으로, [9년간 700%가 넘는 수익](/투자/volatility-break-out-strategy/)을 올릴 수 있는 강력한 전략이다.

# 변동성 돌파전략 
그런데 실제로 이 전략이 백테스트에서 보여준 대단한 수익을 보장할 수 있을까? 장담할 수 없을 것 같다. 전략을 실행하는 건 사람인지라 투자심리의 영향에서 벗어날 수 없기 때문이다. 추세가 형성된 하락장에서 단기적으로 일간 변동성을 돌파했다고 해서 매수 버튼을 누르는건 쉽지않은 선택이다.

## 자동매매 봇
심리의 영향을 없애기 위하여, 변동성 돌파전략을 자동매매 봇으로 만들어서 매매하는 것도 현실적으로 쉽지 않은 접근법이라고 본다. 자동화 프로그램은 복잡해질수록 예외 케이스가 생기기 마련이다. 예상치못한 예외 케이스로 재앙적인 결과가 발생하는 위험에서 벗어날 수 없다. 이 때문에 사람의 손을 완전히 벗어난 매매 프로그램은 (아직까지는)있을 수 없는 것처럼 보인다. 

심지어 [르네상스 테크놀로지](/투자/jim-simons-book)도 프로그램을 반자동화하여 손으로 돌린다는 얘기도 있다. 얼마전에는 [신한증권에서 유동성공급자(LP)의 실수로 1300억 손실](https://www.hankyung.com/article/2024101548106)을 입기도 했다. 프로그램을 돌리는 업무에서 어떻게 손실을 봤는지 이해가 잘 되지않는데, 결국 사람이 하는 일이다보니 그럴 수도 있나보다.

## 전략에 대한 분석이 필요하다
결론적으로 백테스트 결과를 그대로 따르기 보다는 한번 더 뜯어볼 필요가 있다. 그래야 실전에서 전략을 어떠한 방식으로 구사할지 판단할 수 있기 때문이다. 

# 전략의 결과 분석
다시 돌아가서 지난 백테스트 결과를 복기해보자. 백테스트 대상은 Tiger코스닥150레버리지 ETF고, 지난 9년간의 일간 시가, 종가, 고가, 저가 데이터를 이용했다.

## 변동폭과 수익률의 관계
기본적으로 변동성 돌파는 단기 모멘텀을 이용한 전략이라고 생각한다. 단순히 매매일의 주가가 전날 변동폭의 50%(다른 수치를 사용해도 된다.)를 넘으면 사고, 다음날 바로 파는 것이다. 여기서 매수의 기준이되는 가격을 목표가라고 부르면 수식으로 다음과 같이 나타낼 수 있다.

$$
{\text{Target price}} = \text{Open} + 0.5\times\text{(High-Low)}_{\text{yesterday}}
$$

만약 변동폭이 매우 작다면 이를 기준으로 목표가를 설정하는 것은 잡음에 매우 취약할 것이다. 변동폭이 0에 가까운 값이라면 시가에서 조금만 올라도 매수 신호가 발생하기 때문이다. 공학적으로 얘기하면 신호대잡음비(SNR, Signal to Noise Ratio)가 낮다고 표현한다. 

따라서 변동폭이 수익률에 미치는 영향을 살펴보는 것은 유의미한 결과를 보여줄 것이라고 생각한다. 

이러한 아이디어로 지난 백테스트 결과에서 매수 신호가 발생한 날의 전날 변동폭과 일간 수익률의 관계를 조사해봤다. 여기서 전날의 변동폭은 시가로 정규화했다. 

아래의 그림은 변동폭과 수익률의 관계를 나타내는 산점도다. 그림에서 점의 크기는 수익률의 절대값을 나타내고 빨간색과 파란색은 각각 상승과 하락을 나타낸다. 

그림에서 보이듯이, 전체 데이터에서 변동폭과 수익률의 상관계수는 0.13으로 약한 상관관계가 있는 것으로 나타났다. 

표1은 변동폭의 범위에 따른 평균 수익률과 상관계수를 나타낸다. 대부분의 범위에서 거의 미미한 상관계수 값을 갖는 것을 볼 수있다. 변동폭의 범위가 6%~8% 일 때, 가장 상관계수가 높았는데 이때의 산술 평균은 0.51% 이다.

아쉽게도 여기서는 약한 상관관계외의 눈에 띌만한 재밌는 결과를 발견하진 못했다.

<p align="center">   
    <img src="/images/2024-10-19-volatility-break-out-strategy-extend/price_width_vs_return.webp" alt="변동폭에 따른 평균 수익률 결과 그림">
    <br>
   <span style="font-style: italic; color: #FFFFFF;">Fig. 1 변동폭(상대) vs 수익률 </span>
</p>

*표 1: 변동폭에 따른 평균 수익률*

| 변동폭 범위 | 산술 평균 수익률 |상관계수|
|:---:|:---:|:---:|
| 0 % ~ 2 % | 0.29 % |-0.02|
| 2 % ~ 4 % | 0.24 % |0.02|
| 4 % ~ 6 % | 0.54 % |0.04|
| 6 % ~ 8 %  | 0.51 % |0.13|
| 8 % ~ 10 %  | 0.33 % |-0.41|


## 모멘텀과 수익률의 관계
주식의 격언중에 이런 말이 있다.

> 떨어지는 칼날을 잡지마라.

다시 말해서 하락장에는 조심하라는 것이다. 오래도록 구전되어 내려오는 애기니 조심해서 나쁠 것이 없다. 

그렇다면 하락장 또는 상승장과 같은 시장상황은 변동성 돌파 전략의 성과에도 영향을 미치지 않을까. 현재 시장이 상승장인지 하락장인지에 따라서 일간 수익률에 영향을 미칠 것이라는 가정은 합리적으로 보인다.

보통 하락장 또는 상승장을 판단하는 것은 모멘텀이라고 불리는 일정기간 범위에서 정의된 수익률을 기준으로 한다. 따라서 하루 이상의 모멘텀과 전략의 수익률의 관계를 조사하는 것도 흥미로운 결과를 줄 것으로 기대할 수 있다.

여기서는 모멘텀을 기간별로 단기(5일), 중기(10일), 장기(20일)로 구분했다. 장기라고 해도 한달의 기간 밖에 되지 않는데, 더 먼 기간에서는 일간 변동에 미치는 영향이 미미할 것이라는 생각때문이다.

결과부터 얘기하자면 기간에 상관없이 모멘텀과 수익률은 상관관계가 없다. 

### 단기 모멘텀
단기 모멘텀은 5일간의 수익률로 정의했다. 영업일 기준으로 5일은 한주의 시간이다.

아래의 그림은 산점도로 표현한 단기 모멘텀과 수익률의 관계를 보인다. 모멘텀과 수익률의 상관계수는 0.05로 서로 거의 관계가 없다. 표 2는 단기 모멘텀의 범위에 따른 평균 수익률 그리고 상관계수를 보이는데, 마찬가지로 서로 뚜렷한 관계가 없는 것을 볼 수 있다.

<p align="center">   
    <img src="/images/2024-10-19-volatility-break-out-strategy-extend/momentum(5days)_vs_return.webp" alt="단기 모멘텀에 따른 평균 수익률 결과 그림">
    <br>
   <span style="font-style: italic; color: #FFFFFF;">Fig. 2 단기 모멘텀(5일) vs 수익률 </span>
</p>

*표 2: 단기 모멘텀(5일) vs 평균 수익률*

| 모멘텀 범위 | 산술 평균 수익률 |상관계수|
|:---:|:---:|:---:|
| -20 % ~ -15 % | -5.71 % |0.99|
| -15 % ~ -10 % | 1.83 % |-0.39|
| -10 % ~ -5 % | 0.28 % |0.27|
| -5 % ~ 0 % | 0.41 % |-0.06|
| 0 % ~ 5 % | 0.18 % |0.02|
| 5 % ~ 10 % | 0.31 % |0.02|
| 10 % ~ 15 % | 0.94 % |0.31|
| 15 % ~ 20 % | 0.67 % |-0.14|

### 중기 모멘텀
중기 모멘텀은 10일, 즉, 2주간의 수익률로 정의했다. 아래의 그림과 표는 중기 모멘텀과 수익률의 산점도 그리고 범위 별로 평균 수익률과 상관계수를 보인다. 마찬가지로 중기 모멘텀 또한 수익률과 상관관계가 없다.

<p align="center">   
    <img src="/images/2024-10-19-volatility-break-out-strategy-extend/momentum(10days)_vs_return.webp" alt="중기 모멘텀에 따른 평균 수익률 결과 그림">
    <br>
   <span style="font-style: italic; color: #FFFFFF;">Fig. 3 중기 모멘텀(10일) vs 수익률 </span>
</p>

*표 3: 중기 모멘텀(10일) vs 평균 수익률*

| 모멘텀 범위 | 산술 평균 수익률 |상관계수|
|:---:|:---:|:---:|
| -20 % ~ -15 % | 0.11 % |-0.21|
| -15 % ~ -10 % | 0.99 % |-0.03|
| -10 % ~ -5 % | 0.06 % |-0.02|
| -5 % ~ 0 % | 0.35 % |-0.06|
| 0 % ~ 5 % | 0.44 % |-0.03|
| 5 % ~ 10 % | 0.23 % |-0.05|
| 10 % ~ 15 % | 0.55 % |0.09|
| 15 % ~ 20 % | 0.20 % |0.09|

### 장기 모멘텀
장기 모멘텀은 한달 (20일)간의 수익률로 정의했다. 

아래의 그림과 표에서 보이듯이 장기 모멘텀 또한 수익률과 상관관계가 없다.

<p align="center">   
    <img src="/images/2024-10-19-volatility-break-out-strategy-extend/momentum(20days)_vs_return.webp" alt="장기 모멘텀에 따른 평균 수익률 결과 그림">
    <br>
   <span style="font-style: italic; color: #FFFFFF;">Fig. 4 장기 모멘텀(20일) vs 수익률 </span>
</p>

*표 4: 장기 모멘텀(20일) vs 평균 수익률*

| 모멘텀 범위 | 산술 평균 수익률 |상관계수|
|:---:|:---:|:---:|
| -20 % ~ -15 % | 0.81 % |-0.04|
| -15 % ~ -10 % | 0.13 % |0.08|
| -10 % ~ -5 % | 0.12 % |-0.02|
| -5 % ~ 0 % | 0.11 % |-0.11|
| 0 % ~ 5 % | 0.16 % |0.02|
| 5 % ~ 10 % | 0.44 % |-0.1|
| 10 % ~ 15 % | 0.76 % |-0.03|
| 15 % ~ 20 % | 0.15 % |-0.04|

# 결론
결론을 요약하면 아래와 같다.

- 변동성 돌파전략에서 모멘텀 및 변동폭과 수익률이 상관관계가 있을 것으로 생각했다.
- 변동폭과 수익률 사이의 상관계수는 0.13으로 약한 상관관계가 있다.
- 모멘텀과 수익률은 상관관계가 없다.

이 결과는 Tiger코스닥150레버리지 ETF에서만 조사된 것으로 다른 자산에서는 다른 결과가 나올 수있다. 

여기서 얻은 한가지 확실한 결과는 변동성 돌파 신호와 수익률은 거의 상관이 없다는 것이다. 따라서 단순히 변동성 돌파 전략만 가지고는 래리 윌리엄스처럼 엄청난 수익을 올리기는 어렵다는 것이 자명하다. 그 또한 전략에 완전히 의존하지 않고 시장을 읽는 방법을 익혔다고 한다. 전략이 잘먹히는 시장과 아닌 시장을 구분하는 것이 필요한 것이다.