---
layout: single
title:  "[서평-9] 퀀트의 필수 요소 (6/7): 금융공학"
description: 퀀트 투자에 필요한 요소인 금융공학에 대하여 정리하였다.
categories: 투자
tag: [주식,책,퀀트]
toc: true
author_profile: false
header:
 teaser: /images/2024-09-06-quant-elements-financial-engineering/quant-elements-financial-engineering-thumbnail.webp
 og_image: /images/2024-09-06-quant-elements-financial-engineering/quant-elements-financial-engineering-thumbnail.webp

# sidebar:
#     nav: "docs"
# search: true
---
옵션과 선물에 대하여 알면 퀀트 투자 대상과 전략을 넓힐 수 있다.

{: .notice--primary}
<span style="font-size: 1.25em;">이 글은 [퀀트의 정석] 책에 나오는 금융공학 부분을 정리한 것이다.</span>

[퀀트의 정석](/투자/quant-way-book/)

# 금융공학
금융공학은 리스크를 효과적으로 다루기 위한 도구다. 금융공학의 예시는 국내 금융 기고나의 달러 자금 조달 문제를 들 수 있다. 만약, 어떤 국내 시중은행이 지금 당장 달러가 필요한 상황이라고 해보자. 만약 이 은행이 달러 자금시장에서 달러를 직접 조달할 여건이 안된다면, 금융공학이 도움이 될 수 있다. 그 해결책은 바로 만들고자하는 전체 현금흐름을 다른 방식으로 복제하는 것이다. 금융공학에서는 이러한 방식을 '합성'이라고 부른다.

합성의 구체적인 방법은 다음과 같은 총 세개의 거래를 동시에 수행하여 복제 포트폴리오를 만드는 것이다.

1. 원화 자금시장에서 1년 만기로 원화를 차입

2. 외환시장에서 현물 거래로 달러를 매수하고 원화를 매도

3. 외환시장에서 1년 만기 선도 거래로 달러를 매도하고 원화를 매수

# 프라이싱과 헷징
프라이싱은 현재 시점에서 어떤 상품의 이론적 가치를 계산하는 것을 의미한다. 즉, 프라이싱은 자산가격 결정원리를 따른다.  어떤 파생상품에 대한 프라이싱을 한다는 것은 미래에 제공할 모든 현금흐름을 계산한 뒤 할인율을 활용해 현재 가치로 가져오겠다는 의미다. 이렇게 현재 시점으로 할인되어 온 모든 현금흐름을 더하면 그것이 바로 파생상품의 이론적 가치인 것이다.

헷징은 파생상품이 어떤 시장 변수에 영향을 받을지, 만약 받는다면 어느 정도로 받는지를 수치화 하여 목표에 맞게 조치를 취하는 것을 의미한다. 다시 말해, 헷징은 리스크를 제거하는 것이다. 헷징을 하게되면 원래 있던 포지션에 정반대되는 포지션을 잡음으로써 전체 포지션이 시장의 움직임에 영향을 받지 않게되는, 한마디로 리스크가 없는 포지션이 된다. 이는 포지션의 가치가 위로든 아래로든 움직이지 않는다는 것을 의미한다. 즉, 포지션의 변동성이 사라지는 것이다.

# 파생상품
파생상품의 목적은 기초자산에 대한 리스크를 관리하기 위한 것이다. 파생상품은 어떤 자산으로부터 파생되어 나온 상품을 의미한다. 파생되어 나왔기 떄문에 이 파생상품의 움직임은 주식, 금리와 같은 기초자산의 움직임에 영향을 받을 수 밖에 없다. 

파생상품의 역사는 옛날 그리스 시대까지 거슬러 올라간다. 기원전 6세기 그리스의 철학자 탈레스는 천문학을 이용해 그 해 올리브 농사가 풍작이 될 것을 예측한 뒤, 올리브유를 짜내는 데 사용되는 압착기를 사용할 수 있는 권리를 시장에서 전부 매수한다. 올리브가 대풍작을 거두자 사람들은 어쩔 수 없이 탈레스에게 비싼 값에 올리브유 압착기를 빌려 사용할 수 밖에 없었고 탈레스는 이를 통해 큰 돈을 벌었다. 

근대적 의미의 파생상품 거래는 17세기에 등장한다. 17세기 일본에서는 쌀에 대한 선물 옵션 거래가, 네덜란드에서는 튤립에 대한 옵션거래가, 그리고 런던에서는 주식을 기초자산으로 한 옵션 거래가 이루어졌다. 이후 미국을 필두로하여 장내시장과 장외시장에서 여러가지 파생상품이 거래되면서 파생상품 시장은 나날히 성장하게 된다.

국제결제은행 BIS에 따르면 2022년 5월 기준 글로벌 장외파생상품 시장의 규모는 600조 달러에 달한다고 한다. 여기에 장내파생상품 시장의 규모까지 더해진다면, 전세계 파생상품 시장의 규모는 1000조 달러 이상으로 추산된다. 

## 선도
선도는 먼저 거래를 한다는 의미다. 일반적으로 주식을 사는 경우에는 매수를 함과 동시에 현금을 지불하고 주식에 대한 소유권을 얻게된다. 하지만, 선도는 거래 의사가 먼저 발생하고 그 이후에 실물의 교환이 일어난다. 미리 어떤 상품에 대한 예약을 걸어두는 것 처럼 현재 돈은 없지만 거래를 하겠다고 미리 계약을 해놓는 것이다. 선도 계약은 일반적으로 해외 수출을 통해 먹고 사는 우리나라 기업들이 외환 리스크를 헤지하기 위해 주로 사용한다.

## 선물
선물은 선도계약을 정형화, 규격화하여 거래소 시장에 상장된 상품이다. 선도와 선물은 같은 구조를 가지고 있는 상품이지만, 선도와 다르게 선물은 거래 상대방끼리 직접적으로 거래하지 않고 투명성이 보장되는 거래소에서 자유롭게 거래를 할 수 있다는 장점이 있다.

선물시장은 거래상대방 위험을 제거하기 위해 일일정산제도를 활용하고 있다. 이것은 매일매일 장이 마감하면 거래소가 모든 시장 참여자의 손익을 정산하여 결제하는 제도다. 때문에 장내시장에서 선물을 거래하고 싶을 때는 미리 증거금을 납입해 놓아야한다. 매일매일 장이 끝나면 거래소는 정산을 하게 되는데 만약 수익이 발생했다면, 원래 있던 증거금에 추가하여 수익이 쌓이게되고, 반대로 손실을 보았다면 기존의 증거금에서 손실분만큼 돈을 차감한다. 만약 증거금이 충분하지 않은 경우 마진콜이 발생하게된다.

선물은 만기에 따른 기간구조가 존재한다. 즉, 이는 월물별로 가격이 전부 다른 현상을 의미한다. 일반적으로 선물 기간구조는 크게 두가지 모양으로 구분되는데, 하나는 콘탱고이며 다른 하나는 백워데이션이다. 

### 콘탱고
콘탱고는 만기가 길어질수록 선물 가격이 높아서 선물 기간구조가 우상향하는 경우를 말한다. 즉, 현물보다 선물 가격이 높다는 의미이므로, 선물을 매도하는 경우 캐리 수익을 가져갈 수 있다. 시간이 지날수록 선물 가격은 현물에 수렴해가기 때문이다. 

### 백워데이션
백워데이션은 만기가 길어질수록 선물 가격이 낮아져 선물 기간구조가 우하향하는 경우를 말한다. 이때는 당연히 현물보다 선물의 가격이 낮기 때문에 캐리 수익을 얻기 위해서는 선물을 매수해야한다.

## 스왑
스왑은 무언가를 교환하는 형태의 계약을 의미한다. 스왑에는 2년, 10년 등과 같이 만기가 있는데 이 만기가 될 때까지 스왑 계약을 맺은 두 주체는 서로 반대되는 포지션을 교환하게 된다. 대표적으로 이자율 스왑과 통화 스왑이 있다.

### 이자율 스왑
이자율 스왑은 성질이 서로 반대인 금리를 교환하는 파생상품을 의미한다. 여기서 두가지 형태의 금리는 바로 고정금리와 변동금리다. 

### 통화 스왑
통화스왑은 두 거래 상대가 일정 기간동안 통화에 대한 이자를 교환하는 제도를 의미한다. 예를들어 만약 어떤 통화 스왑의 두 통화가 각각 달러와 원화라고 하면, 한 쪽 거래상대방은 원화 자금을 사용한 대가로 원화 이자를 지급하고, 반대쪽은 달러 자금을 사용한 대가로 달러화 이자를 지급한다. 떄문에 일반적인 경우 통화스왑의 거래 시점과 만기 시점에는 두 통화의 원금이 서로 교환된다. 

## 옵션
선도, 선물, 그리고 스왑은 선형 파생상품이라고 한다. 그 이유는 파생상품의 손익구조가 선형이기 떄문이다. 이런 선형 파생상품의 가치는 기초자산과 일대일의 관계를 갖는다. 즉, 기초자산이 상승하면 파생상품이 상승하고 내려가면 같이 내려간다.

옵션은 선형 파생상품과는 다른 새로운 형태의 파생상품이다. 옵션은 선형 파생상품처럼 의무를 지지않으며 선택권을 가질 수 있는 상품이다. 따라서 옵션을 가지고 있는 사람은 유리한 방향으로 의사결정을 내릴 수 있는 선택권이 존재한다. 일반적으로 콜옵션과 풋옵션이 있는데, 콜옵션은 기초자산을 살 수 있는 권리가 있고, 풋옵션은 반대로 기초자산을 팔 수 있는 권리가 있다.

### 블랙-숄즈 방정식
1973년 옵션의 이론적 가치를 계산할 수 있는 블랙-숄즈 방정식이 개발되었다. 이 방정식은 몇가지 변수들의 값만 알면 옵션의 이론적 가치를 계산할 수 있는 도구다. 피셔 블랙과 마이런 숄즈는 이 방정식을 개발한 공로를 인정받아 1997년 노벨 경제학상을 수상했다.

옵션의 가격을 계산하기 위해서는 총 다섯가지의 입력변수가 필요하다. 각각 기초자산의 가격(S), 행사가격(K), 금리(r), 옵션 만기까지의 잔존기간(T-t), 그리고 변동성($\sigma$)이다. 여기서 행사가격이란 옵션의 권리를 행사할 때 기초자산을 사거나 팔 수 있는 가격을 의미한다. 

$$
c(S,t) = SN(d_1) - Ke^{-r(T-t)}N(d_2)\\
p(S,t) = -SN(-d_1) + Ke^{-r(T-t)}N(-d_2)\\
$$

$$
where, d_1 = \frac{ln(S/K)+(r+0.5\sigma^2)(T-t)}{\sigma \sqrt{T-t}}\\
d_2 = d_1-\sigma \sqrt{T-t}
$$

여기서 N은 표준정규분포의 누적 분포 함수를 의미한다. 

행사가격과 현재 기초자산의 가격이 얼마만큼의 차이를 보이고 있느냐에 따라서 일반적으로 옵션은 내가격, 등가격, 그리고 외가격으로 분류된다. 예를 들어, 콜옵션의 기초자산 가격이 행사가격보다 높다면 그 옵션은 내가격 상태에 있다고 한다. 반대로 기초자산 가격이 행사가보다 낮다면 외가격 상태에 있다고 한다. 

### Greeks
블랙-숄즈 방정식에서 유도된 입력변수의 변화 대비 옵션가격의 변화, 즉 민감도를 Greeks라고 한다. 이는 말그대로 그리스 문자를 의미한다. 기본적으로 5가지가 있는데, 각각 $\delta$, $\gamma$, $\theta$, $\nu$, 그리고 $\rho$ 다.

- $\delta$: 기초자산 가격 변화에 대한 옵션 가격 변화의 민감도

- $\gamma$: 시간 변화에 대한 옵셔 가격 변화의 민감도

- $\theta$: 기초자산 가격 변화에 대한 델타 변화의 민감도

- $\nu$: 변동성 변화에 대한 옵션 가격 변화의 민감도

- $\rho$: 금리 변화에 대한 옵션 가격 변화의 민감도

옵션은 다른 선형 파생상품과 다르게 손익구조가 비선형적이며 곡선의 형태를 하고있다. 이러한 비선형성 떄문에 선형 파생상품에서는 존재하지 않던 다른 민감도 들이 나오게 된 것이다.

### 내재 변동성
옵션의 이론적 가치를 합리적으로 추정하기 위해서는 미래의 변동성이 필요하다. 왜냐하면 옵션은 현재부터 만기까지의 기간 동안 효력이 있는 상품이기 때문이다. 미래의 변동성은 정확히 예측할 수 없기 때문에, 블랙-숄즈 방정식으로는 옵션 가격을 정확히 계산하는 것은 어렵다.

하지만 이러한 모델의 한계에도 불구하고 옵션 시장에서는 블랙-숄즈 방정식을 포기하지 않았따. 오히려 모델을 그대로 놓고 실제를 반대로 모델에 맞추기 시작했다. 즉, 현재의 옵션가격을 기준으로 시장에 녹아있는 변동성을 추정했다. 옵션 가격으로 역으로 추정해낸 변동성을 내재 변동성이라고 부른다. 